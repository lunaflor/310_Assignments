
//-----------------------------
// Title: First Assembly Program
//-----------------------------
// Purpose: The program is a heating and cooling control system.
// The basic idea is that the user sets the desired temperature.
// If the environment temperature is higher than the reference temperature,
// the cooling system will be turned on. On the other hand,
// if the environment temperature falls below the reference temperature,
// the heating systems will start. 

// Dependencies:
// Compiler: 
// Author: Flor Luna 
// OUTPUTS: RD1 - connected to PORTD.1, and RD2 - connected to PORTD.2 
// INPUTS: Measured temperature (measuredTemp) and reference temperature (refTemp)
// Versions:
//  	V1.0: 02/28/2024 - First version 
//  	V1.2: 02/29/2024 - Second version
//	V2.3: 03/03/2024 - Third version
//-----------------------------

	ORG 0x20 ;starts program ar 0x20 (R7)

	;set register locations (R8)
	refTemp EQU 0x20
	measuredTemp EQU 0x21
	contReg EQU 0x22

	;INPUT VALUES
	input_measuredTemp EQU 5
	input_refTemp EQU 12

	;move inputs into storage
	MOVLW input_refTemp
	MOVWF refTemp
	MOVLW input_measuredTemp
	MOVWF measuredTemp

	;Check for negative inputs
	GOTO neg_check

BEGIN:	;if measuredTemp = refTemp, contReg = 0
	MOVFW refTemp
	CPFSEQ  measuredTemp, W	;Compare F with W, skip if F = W
	GOTO check_less_or_greater
	GOTO SEG_OFF

check_less_or_greater:
	;measuredTemp<refTemp → contReg=1
	CPFSLT  measuredTemp, W	;Compare F with W, skip if F < W
	GOTO check_if_greater
	GOTO SEG_COLD

check_if_greater:
	;measuredTemp>refTemp → contReg=2
	GOTO SEG_HOT

neg_check:
	MOVWF measuredTemp ;moved measuredTemp to WREG
	BTFSS WREG,7 ;test bit 7 of WREG, if set (neg) then
	GOTO BEGIN
	GOTO SEG_COLD


SEG_OFF:;if measuredTemp = refTemp, contReg = 0
	SLEEP


SEG_COLD:;measuredTemp<refTemp → contReg=1
	INCF contReg, 0x01
	MOVLW 0X00
	MOVWF TRISC
	MOVLW 0X39
	MOVWF PORTC
	MOVLW 0X00
	MOVWF PORTC
	BSF PORTC, 1 ; turns on PORTC.1

	SLEEP

SEG_HOT:;measuredTemp>refTemp → contReg=2
	INCF contReg,0x01
	INCF contReg,0x01
	MOVLW 0X00
	MOVWF TRISC
	MOVLW 0X76
	MOVWF PORTC
	MOVLW 0x00
	MOVWF PORTC
	BSF PORTC, 2 ; turns on PORTC.1
	SLEEP
